<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Relax Space Hub (Sync Fixed)</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body { box-sizing: border-box; touch-action: manipulation; }
html, body { width: 100%; height: 100%; margin: 0; padding: 0; overscroll-behavior: none; }
.app-wrapper { width: 100%; height: 100%; }
.focus-outline:focus-visible { outline: 2px solid #ffffff; outline-offset: 3px; }

/* Animations */
@keyframes fadeOut {
0% { opacity: 1; transform: scale(0); }
100% { opacity: 0; transform: scale(2); }
}
@keyframes rippleExpand {
0% { width: 10px; height: 10px; opacity: 0.8; transform: scale(0.5); }
100% { width: 100px; height: 100px; opacity: 0; transform: scale(2.5); }
}
.breathing-anim { transition: transform 4s ease-in-out; }

/* Block Blast Styles */
.bb-cell { transition: background-color 0.2s, transform 0.1s; }
.bb-shape-btn { transition: transform 0.1s; }
.bb-shape-btn.selected { border: 2px solid #38bdf8; background-color: rgba(56, 189, 248, 0.1); transform: scale(1.1); }
</style>
</head>
<body>
<div id="relax-app" class="app-wrapper bg-[#1a1a1a] text-white flex items-stretch justify-center overflow-y-auto">

<div id="auth-screen" class="w-full max-w-md px-4 py-6 flex flex-col items-center justify-center gap-4">
<div class="w-full rounded-2xl p-6 border border-white/10 bg-white/5">
<h1 class="text-3xl font-semibold mb-2 text-center">Welcome</h1>
<p class="text-sm opacity-80 mb-6 text-center">Login to your space</p>
<form id="auth-form" class="flex flex-col gap-3">
<div><label for="auth-username" class="text-sm font-medium">Username</label> <input type="text" id="auth-username" name="auth-username" class="focus-outline w-full rounded-lg px-3 py-2 text-sm text-white bg-[#1a1a1a] border border-white/20 placeholder-white/30 mt-1" placeholder="Enter username..." required>
</div>
<div><label for="auth-password" class="text-sm font-medium">Password</label> <input type="password" id="auth-password" name="auth-password" class="focus-outline w-full rounded-lg px-3 py-2 text-sm text-white bg-[#1a1a1a] border border-white/20 placeholder-white/30 mt-1" placeholder="Enter password..." required>
</div>
<div class="flex gap-2"><button type="submit" id="login-btn" class="focus-outline text-sm px-5 py-2 rounded-full bg-[#38bdf8] hover:bg-[#0ea5e9] text-[#020617] font-semibold transition flex-1"> Login </button> <button type="button" id="register-btn" class="focus-outline text-sm px-5 py-2 rounded-full border border-white/20 hover:bg-white/10 transition flex-1"> Register </button>
</div>
</form>
</div>
</div>

<div id="main-app" class="hidden w-full max-w-5xl px-3 sm:px-4 py-4 sm:py-6 flex flex-col gap-3 sm:gap-4">
<header class="w-full flex items-center justify-between">
<div class="flex flex-col gap-1">
<h1 id="main-title" class="text-2xl sm:text-3xl font-semibold tracking-tight">Your Quiet Corner</h1>
<p id="subtitle-text" class="text-xs sm:text-sm opacity-80">Pick a mood, share a thought, join a group.</p>
</div>
<div class="flex items-center gap-2"><span id="current-username" class="text-xs sm:text-sm opacity-80"></span> <button type="button" id="logout-btn" class="focus-outline text-xs px-3 py-1.5 rounded-full border border-white/20 hover:bg-white/10 transition"> Logout </button>
</div>
</header>
<main class="flex-1 w-full flex flex-col gap-3 sm:gap-4">

<section class="w-full rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-white/10 bg-white/5" id="mode-card">
<h2 id="modes-label" class="text-sm sm:text-base font-semibold mb-2 sm:mb-3">Choose your mood</h2>
<div class="flex flex-wrap gap-1.5 sm:gap-2" role="radiogroup">
<button type="button" class="mode-btn focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/20 bg-white/10 hover:bg-white/20 transition" data-mode="Calm"> üåä Calm </button>
<button type="button" class="mode-btn focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/10 hover:bg-white/15 transition" data-mode="Dreamy"> ‚ú® Dreamy </button>
<button type="button" class="mode-btn focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/10 hover:bg-white/15 transition" data-mode="Cozy"> üî• Cozy </button>
<button type="button" class="mode-btn focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/10 hover:bg-white/15 transition" data-mode="Good"> üòä Good </button>
<button type="button" class="mode-btn focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/10 hover:bg-white/15 transition" data-mode="Sad"> üò¢ Sad </button>
<button type="button" class="mode-btn focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/10 hover:bg-white/15 transition" data-mode="Angry"> üò§ Angry </button>
</div>
</section>

<section class="w-full rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-white/10 bg-white/5">
<div class="flex items-center justify-between mb-2 sm:mb-3">
<h2 class="text-sm sm:text-base font-semibold">Groups</h2><button type="button" id="create-group-btn" class="focus-outline text-xs px-3 sm:px-4 py-1.5 sm:py-2 rounded-full bg-[#38bdf8] hover:bg-[#0ea5e9] text-[#020617] font-semibold transition"> + Create </button>
</div>
<div id="create-group-form" class="hidden mb-3 sm:mb-4 p-2.5 sm:p-3 rounded-xl bg-[#020617]/50 border border-white/20">
<form id="group-form" class="flex flex-col gap-2.5 sm:gap-3">
<div><label for="group-name" class="text-xs sm:text-sm font-medium">Group Name</label> <input type="text" id="group-name" name="group-name" class="focus-outline w-full rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm text-white bg-[#1a1a1a] border border-white/20 placeholder-white/30 mt-1" placeholder="Enter group name..." required>
</div>
<div><label for="group-password" class="text-xs sm:text-sm font-medium">Password (optional)</label> <input type="password" id="group-password" name="group-password" class="focus-outline w-full rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm text-white bg-[#1a1a1a] border border-white/20 placeholder-white/30 mt-1" placeholder="Leave empty for no password...">
</div>
<div class="flex gap-2"><button type="submit" class="focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full bg-[#38bdf8] hover:bg-[#0ea5e9] text-[#020617] font-semibold transition"> Create </button> <button type="button" id="cancel-group-btn" class="focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/20 hover:bg-white/10 transition"> Cancel </button>
</div>
</form>
</div>
<div id="groups-list" class="flex flex-wrap gap-1.5 sm:gap-2">
<button type="button" id="all-posts-btn" class="focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/30 bg-white/20 hover:bg-white/25 transition"> üìã All Posts </button>
</div>
</section>

<div id="main-view" class="w-full flex flex-col gap-3 sm:gap-4">
<div class="w-full grid grid-cols-1 lg:grid-cols-2 gap-3 sm:gap-4">
<section class="rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-white/10 bg-white/5">
<h2 class="text-sm sm:text-base font-semibold mb-2 sm:mb-3">Share a thought</h2>
<form id="post-form" class="flex flex-col gap-2.5 sm:gap-3"><textarea id="post-text" name="post-text" rows="3" class="focus-outline w-full rounded-xl px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm text-white bg-[#020617]/50 border border-white/20 placeholder-white/30 resize-none" placeholder="What's on your mind?"></textarea>
<div class="flex items-center justify-between gap-2 sm:gap-3">
<p id="form-status" class="text-xs opacity-80 text-[#38bdf8]"></p><button id="post-submit" type="submit" class="focus-outline text-xs sm:text-sm px-4 sm:px-5 py-1.5 sm:py-2 rounded-full bg-[#38bdf8] hover:bg-[#0ea5e9] text-[#020617] font-semibold transition"> Share </button>
</div>
</form>
</section>
<section class="rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-white/10 bg-white/5 flex flex-col gap-2 sm:gap-3">
<h2 class="text-sm sm:text-base font-semibold" id="feed-title">Community Board <span class="text-[10px] opacity-50 font-normal ml-2">‚óè Live</span></h2>
<div id="feed-empty" class="text-xs sm:text-sm opacity-75">No posts yet.</div>
<ul id="feed-list" class="flex flex-col gap-2 text-xs sm:text-sm max-h-64 overflow-y-auto pr-1"></ul>
</section>
</div>

<section class="rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-white/10 bg-white/5">
<h2 class="text-sm sm:text-base font-semibold mb-3">üé® Drawing Gallery</h2>
<div id="gallery-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2">
<p class="text-xs opacity-50 col-span-full">Post your drawings in the game to see them here!</p>
</div>
</section>
</div>

<div id="group-view" class="hidden w-full flex flex-col gap-3 sm:gap-4 relative">
<div class="w-full rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-white/10 bg-white/5 flex items-center justify-between">
<div class="flex items-center gap-2">
<h2 id="group-view-title" class="text-base sm:text-lg font-semibold">Group Chat</h2>
<button id="group-settings-btn" class="text-xs p-1.5 rounded-full hover:bg-white/10 border border-transparent hover:border-white/20">‚öôÔ∏è</button>
</div>
<button type="button" id="exit-group-btn" class="focus-outline text-xs sm:text-sm px-2.5 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/20 hover:bg-white/10 transition"> ‚Üê Back to Main </button>
</div>

<div id="group-settings-menu" class="hidden absolute top-16 left-4 z-20 w-48 bg-[#1a1a1a] border border-white/20 rounded-xl shadow-xl p-2 flex flex-col gap-1">
<p class="text-xs font-bold px-2 py-1 text-white/50 border-b border-white/10">Settings</p>
<button id="delete-group-btn" class="text-left text-xs text-red-400 hover:bg-red-500/10 px-2 py-1.5 rounded">Delete Group</button>
<button id="close-settings-btn" class="text-left text-xs hover:bg-white/10 px-2 py-1.5 rounded">Close</button>
</div>

<div class="w-full rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-white/10 bg-white/5 flex flex-col gap-3 sm:gap-4">
<ul id="group-messages-list" class="flex flex-col gap-2 text-xs sm:text-sm max-h-96 overflow-y-auto pr-1 min-h-[150px]">
<li class="text-center opacity-50 italic mt-4">Welcome to the group chat.</li>
</ul>
<form id="group-message-form" class="flex flex-col gap-2.5 sm:gap-3 border-t border-white/10 pt-3 sm:pt-4">
<textarea id="group-message-text" rows="2" class="focus-outline w-full rounded-xl px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm text-white bg-[#020617]/50 border border-white/20 placeholder-white/30 resize-none" placeholder="Type message..."></textarea>
<button type="submit" class="focus-outline text-xs sm:text-sm px-4 sm:px-5 py-1.5 sm:py-2 rounded-full bg-[#38bdf8] hover:bg-[#0ea5e9] text-[#020617] font-semibold self-end">Send</button>
</form>
</div>
</div>

<section class="w-full rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-white/10 bg-white/5 flex flex-col gap-3 sm:gap-4">
<div class="flex flex-col sm:flex-row sm:items-center justify-between gap-2">
<h2 class="text-sm sm:text-base font-semibold">Mini Games</h2>
<div class="flex flex-wrap gap-1.5 sm:gap-2">
<button type="button" class="game-btn focus-outline text-xs px-2.5 sm:px-3 py-1 rounded-full border border-white/20 bg-white/10 hover:bg-white/20" data-game="breathing">ü´Å Breathe</button>
<button type="button" class="game-btn focus-outline text-xs px-2.5 sm:px-3 py-1 rounded-full border border-white/10 hover:bg-white/15" data-game="stars">‚≠ê Stars</button>
<button type="button" class="game-btn focus-outline text-xs px-2.5 sm:px-3 py-1 rounded-full border border-white/10 hover:bg-white/15" data-game="ripple">üíß Ripple</button>
<button type="button" class="game-btn focus-outline text-xs px-2.5 sm:px-3 py-1 rounded-full border border-white/10 hover:bg-white/15" data-game="drawing">üé® Drawing</button>
<button type="button" class="game-btn focus-outline text-xs px-2.5 sm:px-3 py-1 rounded-full border border-white/10 hover:bg-white/15" data-game="blockblast">üß± Block Blast</button>
<button type="button" class="game-btn focus-outline text-xs px-2.5 sm:px-3 py-1 rounded-full border border-white/10 hover:bg-white/15" data-game="popcorn">üçø Popcorn</button>
<button type="button" class="game-btn focus-outline text-xs px-2.5 sm:px-3 py-1 rounded-full border border-white/10 hover:bg-white/15" data-game="snake">üêç Snake Battle</button>
</div>
</div>

<div id="breathing-game" class="hidden flex-col items-center gap-3 sm:gap-4">
<div class="w-28 h-28 sm:w-32 sm:h-32 rounded-full border-2 border-[#38bdf8] flex items-center justify-center bg-white/5 breathing-anim" id="breathing-circle"><span id="breathing-label" class="text-xs sm:text-sm opacity-80">Inhale‚Ä¶</span>
</div><button type="button" id="breathing-toggle" class="focus-outline text-xs sm:text-sm px-4 sm:px-5 py-1.5 sm:py-2 rounded-full bg-[#38bdf8] hover:bg-[#0ea5e9] text-[#020617] font-semibold transition"> Start </button>
</div>

<div id="stars-game" class="hidden flex-col items-center gap-3 sm:gap-4">
<div class="w-full h-40 sm:h-48 rounded-xl border border-white/10 relative overflow-hidden" id="stars-canvas" style="background-color: #2a2a2a;"></div>
<p class="text-xs opacity-75 text-center">Tap to create stars</p>
</div>

<div id="ripple-game" class="hidden flex-col items-center gap-3 sm:gap-4">
<div class="w-full h-40 sm:h-48 rounded-xl border border-white/10 relative overflow-hidden" id="ripple-canvas" style="background-color: #2a2a2a; touch-action: none;"></div>
<p class="text-xs opacity-75 text-center">Move to create large ripples</p>
</div>

<div id="drawing-game" class="hidden flex-col gap-3 sm:gap-4">
<div class="flex flex-col gap-2">
<div class="flex justify-between items-center"><span class="text-xs opacity-70">Tools:</span>
<div class="flex gap-2">
<button id="post-drawing-btn" class="text-xs px-3 py-1 rounded bg-green-500/20 text-green-400 border border-green-500/50 hover:bg-green-500/30">Post to Gallery</button>
<button id="clear-canvas" class="text-xs border px-2 py-1 rounded border-white/20">Clear</button>
</div>
</div>
<div class="flex flex-wrap gap-2">
<button class="tool-btn text-xs px-2 py-1 rounded bg-[#38bdf8]/20 border border-[#38bdf8]" data-tool="pen">üñäÔ∏è Pen</button>
<button class="tool-btn text-xs px-2 py-1 rounded border border-white/20" data-tool="brush">üñåÔ∏è Brush</button>
<button class="tool-btn text-xs px-2 py-1 rounded border border-white/20" data-tool="marker">‚úèÔ∏è Marker</button>
<button class="tool-btn text-xs px-2 py-1 rounded border border-white/20" data-tool="eraser">üßπ Eraser</button>
</div>
<div class="flex flex-wrap gap-2 items-center">
<span class="text-xs opacity-60">Size:</span>
<button class="size-btn text-xs px-2 py-1 rounded border border-white/20" data-size="2">Thin</button>
<button class="size-btn text-xs px-2 py-1 rounded bg-[#38bdf8]/20 border border-[#38bdf8]" data-size="5">Normal</button>
<button class="size-btn text-xs px-2 py-1 rounded border border-white/20" data-size="10">Thick</button>
</div>
<div class="flex flex-wrap gap-2">
<button class="color-btn w-6 h-6 rounded-full bg-[#38bdf8] border-2 border-white" data-draw-color="#38bdf8"></button>
<button class="color-btn w-6 h-6 rounded-full bg-[#ffffff] border-2 border-white/20" data-draw-color="#ffffff"></button>
<button class="color-btn w-6 h-6 rounded-full bg-[#ef4444] border-2 border-white/20" data-draw-color="#ef4444"></button>
<button class="color-btn w-6 h-6 rounded-full bg-[#22c55e] border-2 border-white/20" data-draw-color="#22c55e"></button>
<button class="color-btn w-6 h-6 rounded-full bg-[#eab308] border-2 border-white/20" data-draw-color="#eab308"></button>
<button class="color-btn w-6 h-6 rounded-full bg-[#a855f7] border-2 border-white/20" data-draw-color="#a855f7"></button>
</div>
</div>
<canvas id="drawing-canvas" width="800" height="400" class="w-full rounded-xl border border-white/10 cursor-crosshair" style="background-color: #2a2a2a; touch-action: none;"></canvas>
</div>

<div id="blockblast-game" class="hidden flex-col gap-3 sm:gap-4">
<div class="flex items-center justify-between gap-2">
<p class="text-xs sm:text-sm font-semibold">Score: <span id="bb-score">0</span></p>
<button type="button" id="bb-reset" class="focus-outline text-xs px-2.5 sm:px-3 py-1 rounded-full border border-white/20 hover:bg-white/15">Restart</button>
</div>
<div id="bb-grid" class="grid grid-cols-8 gap-0.5 sm:gap-1 w-full max-w-[300px] mx-auto p-1.5 sm:p-2 rounded-xl bg-[#020617]/50 border border-white/10 aspect-square"></div>
<div id="bb-shapes" class="flex justify-center gap-4 h-24 items-center"></div>
</div>

<div id="popcorn-game" class="hidden flex-col gap-3 sm:gap-4">
<div class="flex items-center justify-between gap-2">
<p class="text-xs sm:text-sm font-semibold">Score: <span id="popcorn-score">0</span></p>
<button type="button" id="popcorn-reset" class="focus-outline text-xs px-2.5 sm:px-3 py-1 rounded-full border border-white/20 hover:bg-white/15">Start</button>
</div>
<canvas id="popcorn-canvas" width="600" height="400" class="w-full rounded-xl border border-white/10" style="background: linear-gradient(to bottom, #2a2a2a, #1a1a1a); touch-action: none;"></canvas>
</div>

<div id="snake-game" class="hidden flex-col gap-3 sm:gap-4">
<div id="snake-menu" class="flex flex-col items-center justify-center gap-4 h-64 bg-white/5 rounded-xl border border-white/10">
<h3 class="text-lg font-bold">Snake Battle Arena</h3>
<div class="flex gap-3">
<button id="snake-single-btn" class="px-4 py-2 bg-[#38bdf8] text-black rounded-full font-bold hover:bg-[#0ea5e9]">Solo Practice</button>
<button id="snake-online-btn" class="px-4 py-2 border border-white/30 rounded-full hover:bg-white/10">Online (Multiplayer)</button>
</div>
</div>
<div id="snake-servers" class="hidden flex-col gap-3 h-64 bg-white/5 rounded-xl border border-white/10 p-4">
<h3 class="text-sm font-bold border-b border-white/10 pb-2">Select Server</h3>
<div class="flex flex-col gap-2 overflow-y-auto">
<button class="server-item text-left px-3 py-2 bg-white/5 hover:bg-white/10 rounded flex justify-between" data-server="NA-East-1">
<span>Server: NA-East-1</span> <span class="text-[#22c55e]">9/10 Players</span>
</button>
<button class="server-item text-left px-3 py-2 bg-white/5 hover:bg-white/10 rounded flex justify-between" data-server="EU-West-1">
<span>Server: EU-West-1</span> <span class="text-[#22c55e]">5/10 Players</span>
</button>
</div>
<button id="back-to-menu" class="text-xs text-center mt-2 opacity-50">Back</button>
</div>
<div id="snake-lobby" class="hidden flex-col gap-3 h-64 bg-white/5 rounded-xl border border-white/10 p-4">
<div class="flex justify-between items-center border-b border-white/10 pb-2">
<h3 class="text-sm font-bold">Lobby</h3>
<span class="text-xs opacity-70" id="lobby-server-name"></span>
</div>
<div class="flex-1 overflow-y-auto" id="lobby-list"></div>
<button id="lobby-start-btn" class="w-full py-2 bg-[#22c55e] text-black font-bold rounded-lg opacity-50 cursor-not-allowed">Waiting for players...</button>
</div>
<div id="snake-play-area" class="hidden flex-col gap-2">
<div class="flex justify-between">
<span id="snake-status-text" class="text-xs font-bold text-[#38bdf8]">Alive</span>
<button id="snake-quit" class="text-xs px-2 border rounded border-white/20">Quit</button>
</div>
<canvas id="snake-canvas" width="600" height="400" class="w-full rounded-xl border border-white/10" style="background-color: #2a2a2a;"></canvas>
</div>
</div>
</section>
</main>
</div>
</div>

<script>
// --- STORAGE & SYNC ---
let currentUser = sessionStorage.getItem('relaxUser');
let isAdmin = false;
let currentGroup = null;

// Load data from LocalStorage
function loadData(key) { return JSON.parse(localStorage.getItem(key)) || []; }
function saveData(key, data) { localStorage.setItem(key, JSON.stringify(data)); }

// Initial Load
let allGroups = loadData('relax_groups');
let allPosts = loadData('relax_posts');
let allGallery = loadData('relax_gallery');
let allGroupMsgs = loadData('relax_group_msgs') || {}; // Object key=groupName, val=array

// --- AUTO-REFRESH PULSE (The Fix) ---
// This checks for updates every 1 second
setInterval(() => {
const freshPosts = loadData('relax_posts');
const freshGroups = loadData('relax_groups');
const freshGallery = loadData('relax_gallery');
const freshGroupMsgs = loadData('relax_group_msgs') || {};

// If posts changed in another tab, update
if (JSON.stringify(freshPosts) !== JSON.stringify(allPosts)) {
allPosts = freshPosts;
renderPosts();
}
// If groups changed
if (JSON.stringify(freshGroups) !== JSON.stringify(allGroups)) {
allGroups = freshGroups;
renderGroups();
}
// If gallery changed
if (JSON.stringify(freshGallery) !== JSON.stringify(allGallery)) {
allGallery = freshGallery;
renderGallery();
}
// If inside a group, check for new messages
if(currentGroup) {
const currentMsgs = allGroupMsgs[currentGroup] || [];
const freshMsgs = freshGroupMsgs[currentGroup] || [];
if(JSON.stringify(currentMsgs) !== JSON.stringify(freshMsgs)) {
allGroupMsgs = freshGroupMsgs;
renderGroupMessages(currentGroup);
}
} else {
allGroupMsgs = freshGroupMsgs;
}

}, 1000);
// ^^^ This 1000ms timer forces the app to look for changes

function showApp(name) {
document.getElementById('current-username').textContent = "Hi, " + name;
document.getElementById('auth-screen').classList.add('hidden');
document.getElementById('main-app').classList.remove('hidden');

if(name === 'Ray_irl'){
isAdmin = true;
document.getElementById('current-username').innerHTML = "Hi, Ray_irl <span class='text-xs bg-red-500 px-1 rounded ml-1'>ADMIN</span>";
}
renderGroups();
renderPosts();
renderGallery();
}

if(currentUser) showApp(currentUser);

document.getElementById('auth-form').addEventListener('submit', (e) => {
e.preventDefault();
const val = document.getElementById('auth-username').value;
if(val) {
currentUser = val;
sessionStorage.setItem('relaxUser', currentUser);
showApp(currentUser);
}
});

document.getElementById('logout-btn').addEventListener('click', () => {
sessionStorage.removeItem('relaxUser');
location.reload();
});

// --- NAVIGATION ---
function showMainView() {
document.getElementById('main-view').classList.remove('hidden');
document.getElementById('group-view').classList.add('hidden');
currentGroup = null;
}
function showGroupView(groupName) {
currentGroup = groupName;
document.getElementById('main-view').classList.add('hidden');
document.getElementById('group-view').classList.remove('hidden');
document.getElementById('group-view-title').textContent = groupName;
document.getElementById('group-settings-menu').classList.add('hidden');
renderGroupMessages(groupName);
}

document.getElementById('all-posts-btn').onclick = showMainView;
document.getElementById('exit-group-btn').onclick = showMainView;

// --- POSTS & FEED ---
function renderPosts() {
const list = document.getElementById('feed-list');
list.innerHTML = '';
if(allPosts.length === 0) {
document.getElementById('feed-empty').classList.remove('hidden');
} else {
document.getElementById('feed-empty').classList.add('hidden');
allPosts.forEach((post, index) => {
const li = document.createElement('li');
li.className = "p-2 rounded bg-white/5 border border-white/5 flex justify-between items-start animate-[fadeIn_0.3s]";
const contentDiv = document.createElement('div');
contentDiv.innerHTML = `<span class="font-bold text-[#38bdf8]">${post.user}:</span> ${post.text}`;
li.appendChild(contentDiv);

if(isAdmin) {
const delBtn = document.createElement('button');
delBtn.innerText = "Delete";
delBtn.className = "text-white bg-red-500 hover:bg-red-600 text-[10px] uppercase font-bold ml-2 px-2 py-0.5 rounded";
delBtn.onclick = () => {
allPosts.splice(index, 1);
saveData('relax_posts', allPosts);
renderPosts();
};
li.appendChild(delBtn);
}
list.prepend(li);
});
}
}

document.getElementById('post-form').addEventListener('submit', (e) => {
e.preventDefault();
const text = document.getElementById('post-text').value;
if(!text) return;

allPosts.push({ user: currentUser, text: text, time: Date.now() });
saveData('relax_posts', allPosts);
renderPosts();
document.getElementById('post-text').value = '';
document.getElementById('form-status').textContent = "Sent!";
setTimeout(() => document.getElementById('form-status').textContent = "", 2000);
});

// --- GROUPS ---
const groupForm = document.getElementById('create-group-form');
document.getElementById('create-group-btn').onclick = () => groupForm.classList.remove('hidden');
document.getElementById('cancel-group-btn').onclick = () => groupForm.classList.add('hidden');

function renderGroups() {
const list = document.getElementById('groups-list');
list.innerHTML = '';
const allBtn = document.createElement('button');
allBtn.type="button";
allBtn.id="all-posts-btn";
allBtn.className="focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/30 bg-white/20 hover:bg-white/25 transition";
allBtn.textContent="üìã All Posts";
allBtn.onclick = showMainView;
list.appendChild(allBtn);

allGroups.forEach(g => {
const btn = document.createElement('button');
btn.type = 'button';
btn.className = "focus-outline text-xs sm:text-sm px-3 sm:px-4 py-1.5 sm:py-2 rounded-full border border-white/10 hover:bg-white/15 transition";
btn.textContent = "# " + g.name + (g.password ? " üîí" : "");

btn.onclick = () => {
if(isAdmin) {
showGroupView("# " + g.name);
} else if (g.password) {
let attempt = prompt("Enter password for " + g.name + ":");
if(attempt === g.password) {
showGroupView("# " + g.name);
} else {
alert("Wrong password!");
}
} else {
showGroupView("# " + g.name);
}
};
list.appendChild(btn);
});
}

document.getElementById('group-form').addEventListener('submit', (e) => {
e.preventDefault();
const gName = document.getElementById('group-name').value;
const gPass = document.getElementById('group-password').value;

if(gName) {
allGroups.push({ name: gName, password: gPass });
saveData('relax_groups', allGroups);
renderGroups();
document.getElementById('group-name').value = '';
document.getElementById('group-password').value = '';
groupForm.classList.add('hidden');
}
});

// --- GROUP SETTINGS ---
const settingsBtn = document.getElementById('group-settings-btn');
const settingsMenu = document.getElementById('group-settings-menu');
const deleteGroupBtn = document.getElementById('delete-group-btn');

settingsBtn.onclick = () => {
settingsMenu.classList.toggle('hidden');
};
document.getElementById('close-settings-btn').onclick = () => settingsMenu.classList.add('hidden');

deleteGroupBtn.onclick = () => {
if(!isAdmin) {
alert("Only Admin can delete groups right now.");
return;
}
if(confirm("Delete this group permanently?")) {
const cleanName = currentGroup.replace("# ", "");
allGroups = allGroups.filter(g => g.name !== cleanName);
saveData('relax_groups', allGroups);
renderGroups();
showMainView();
}
};

// --- GROUP MESSAGING (Persistent) ---
function renderGroupMessages(group) {
const list = document.getElementById('group-messages-list');
list.innerHTML = '<li class="text-center opacity-50 italic mt-4 text-xs">Welcome to the group chat.</li>';

const msgs = allGroupMsgs[group] || [];
msgs.forEach(m => {
const li = document.createElement('li');
li.className = "p-2 bg-white/5 rounded border border-white/5 break-words";
li.innerHTML = `<span class="font-bold text-[#38bdf8]">${m.user}:</span> ${m.text}`;
list.appendChild(li);
});
list.scrollTop = list.scrollHeight;
}

document.getElementById('group-message-form').addEventListener('submit', (e) => {
e.preventDefault();
const txt = document.getElementById('group-message-text').value;
if(txt && currentGroup) {
if(!allGroupMsgs[currentGroup]) allGroupMsgs[currentGroup] = [];
allGroupMsgs[currentGroup].push({ user: currentUser, text: txt, time: Date.now() });

saveData('relax_group_msgs', allGroupMsgs);
renderGroupMessages(currentGroup);
document.getElementById('group-message-text').value = '';
}
});

// --- DRAWING GALLERY LOGIC ---
function renderGallery() {
const container = document.getElementById('gallery-container');
// Keep the placeholder text if empty
if(allGallery.length === 0) {
container.innerHTML = '<p class="text-xs opacity-50 col-span-full">Post your drawings in the game to see them here!</p>';
return;
}
container.innerHTML = '';
allGallery.forEach(imgData => {
const div = document.createElement('div');
div.className = "aspect-video bg-black rounded border border-white/20 overflow-hidden relative group";
const img = document.createElement('img');
img.src = imgData.data;
img.className = "w-full h-full object-cover";

const info = document.createElement('div');
info.className = "absolute bottom-0 left-0 right-0 bg-black/70 p-1 text-[10px] text-white opacity-0 group-hover:opacity-100 transition";
info.textContent = "By " + imgData.user;

div.appendChild(img);
div.appendChild(info);
container.prepend(div);
});
}

// --- MODE SWITCHING ---
const modeColors = {
'Calm': 'bg-[#0f172a]',
'Dreamy': 'bg-[#2e1065]',
'Cozy': 'bg-[#431407]',
'Good': 'bg-[#14532d]',
'Sad': 'bg-[#1a1a1a]', // Default dark
'Angry': 'bg-[#450a0a]'
};

document.querySelectorAll('.mode-btn').forEach(btn => {
btn.onclick = () => {
const mode = btn.dataset.mode;
const app = document.getElementById('relax-app');
// Remove old colors
Object.values(modeColors).forEach(c => app.classList.remove(c));
// Add new color
if(modeColors[mode]) app.classList.add(modeColors[mode]);

// Visual selection
document.querySelectorAll('.mode-btn').forEach(b => {
b.classList.remove('bg-white/20', 'border-white/20');
b.classList.add('border-white/10');
});
btn.classList.remove('border-white/10');
btn.classList.add('bg-white/20', 'border-white/20');
};
});

// --- GAME TABS LOGIC ---
const gameIds = ['breathing', 'stars', 'ripple', 'drawing', 'blockblast', 'popcorn', 'snake'];

document.querySelectorAll('.game-btn').forEach(btn => {
btn.onclick = () => {
// UI Update
document.querySelectorAll('.game-btn').forEach(b => {
b.classList.remove('bg-white/10', 'border-white/20');
b.classList.add('border-white/10');
});
btn.classList.remove('border-white/10');
btn.classList.add('bg-white/10', 'border-white/20');

// Hide all games
gameIds.forEach(id => document.getElementById(id + '-game').classList.add('hidden'));

// Show selected
const selected = btn.dataset.game;
document.getElementById(selected + '-game').classList.remove('hidden');
document.getElementById(selected + '-game').classList.add('flex');

// Init specific game loops if needed
if(selected === 'stars') initStars();
if(selected === 'ripple') initRipple();
if(selected === 'drawing') initDrawing();
if(selected === 'blockblast') initBlockBlast();
if(selected === 'popcorn') initPopcorn();
// Snake inits on its own menu
};
});

// --- MINI GAME: BREATHING ---
const breathCircle = document.getElementById('breathing-circle');
const breathLabel = document.getElementById('breathing-label');
let breathState = 0; // 0=in, 1=hold, 2=out
let breathInterval;

document.getElementById('breathing-toggle').onclick = (e) => {
const btn = e.target;
if(btn.textContent.trim() === 'Start') {
btn.textContent = 'Stop';
runBreathing();
} else {
btn.textContent = 'Start';
stopBreathing();
}
};

function runBreathing() {
breathLoop();
breathInterval = setInterval(breathLoop, 4000); // 4s cycles
}

function stopBreathing() {
clearInterval(breathInterval);
breathCircle.style.transform = 'scale(1)';
breathLabel.textContent = 'Inhale...';
breathState = 0;
}

function breathLoop() {
if(breathState === 0) {
breathCircle.style.transform = 'scale(1.5)';
breathLabel.textContent = 'Hold';
breathState = 1;
} else if(breathState === 1) {
breathCircle.style.transform = 'scale(1)';
breathLabel.textContent = 'Exhale';
breathState = 2;
} else {
breathLabel.textContent = 'Inhale';
breathState = 0;
}
}

// --- MINI GAME: STARS ---
function initStars() {
const canvas = document.getElementById('stars-canvas');
canvas.innerHTML = '';
canvas.onclick = (e) => {
const rect = canvas.getBoundingClientRect();
const x = e.clientX - rect.left;
const y = e.clientY - rect.top;
createStar(x, y, canvas);
};
}

function createStar(x, y, container) {
const star = document.createElement('div');
star.innerText = '‚≠ê';
star.style.position = 'absolute';
star.style.left = x + 'px';
star.style.top = y + 'px';
star.style.fontSize = Math.random() * 20 + 10 + 'px';
star.style.animation = 'fadeOut 2s forwards';
container.appendChild(star);
setTimeout(() => star.remove(), 2000);
}

// --- MINI GAME: RIPPLE ---
function initRipple() {
const canvas = document.getElementById('ripple-canvas');
canvas.innerHTML = '';
canvas.onpointermove = (e) => {
const rect = canvas.getBoundingClientRect();
createRipple(e.clientX - rect.left, e.clientY - rect.top, canvas);
};
}

function createRipple(x, y, container) {
const rip = document.createElement('div');
rip.style.position = 'absolute';
rip.style.left = (x-5) + 'px';
rip.style.top = (y-5) + 'px';
rip.style.borderRadius = '50%';
rip.style.border = '1px solid rgba(56, 189, 248, 0.5)';
rip.style.animation = 'rippleExpand 1.5s linear forwards';
container.appendChild(rip);
setTimeout(() => rip.remove(), 1500);
}

// --- MINI GAME: DRAWING ---
let ctx, isDrawing = false;
let drawColor = '#38bdf8';
let drawSize = 5;
let tool = 'pen';

function initDrawing() {
const cvs = document.getElementById('drawing-canvas');
ctx = cvs.getContext('2d');
// Handle resizing basics
cvs.width = cvs.clientWidth;
cvs.height = cvs.clientHeight;

const startDraw = (e) => {
isDrawing = true;
ctx.beginPath();
const rect = cvs.getBoundingClientRect();
let x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
let y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
ctx.moveTo(x, y);
};

const draw = (e) => {
if(!isDrawing) return;
e.preventDefault(); // Stop scroll on mobile
const rect = cvs.getBoundingClientRect();
let x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
let y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;

ctx.lineWidth = drawSize;
ctx.lineCap = 'round';

if(tool === 'eraser') {
ctx.strokeStyle = '#2a2a2a'; // Match bg
} else {
ctx.strokeStyle = drawColor;
}

if(tool === 'brush') ctx.shadowBlur = 5;
else ctx.shadowBlur = 0;

if(tool === 'marker') ctx.globalAlpha = 0.5;
else ctx.globalAlpha = 1.0;

ctx.shadowColor = drawColor;
ctx.lineTo(x, y);
ctx.stroke();
};

const stopDraw = () => isDrawing = false;

cvs.addEventListener('mousedown', startDraw);
cvs.addEventListener('mousemove', draw);
cvs.addEventListener('mouseup', stopDraw);
cvs.addEventListener('touchstart', startDraw);
cvs.addEventListener('touchmove', draw);
cvs.addEventListener('touchend', stopDraw);
}

// Drawing Tools
document.querySelectorAll('.color-btn').forEach(btn => {
btn.onclick = () => {
drawColor = btn.dataset.drawColor;
document.querySelectorAll('.color-btn').forEach(b => b.classList.replace('border-white', 'border-white/20'));
btn.classList.replace('border-white/20', 'border-white');
};
});

document.querySelectorAll('.size-btn').forEach(btn => {
btn.onclick = () => {
drawSize = parseInt(btn.dataset.size);
// Visual feedback
document.querySelectorAll('.size-btn').forEach(b => {
b.classList.remove('bg-[#38bdf8]/20', 'border-[#38bdf8]');
b.classList.add('border-white/20');
});
btn.classList.remove('border-white/20');
btn.classList.add('bg-[#38bdf8]/20', 'border-[#38bdf8]');
};
});

document.querySelectorAll('.tool-btn').forEach(btn => {
btn.onclick = () => {
tool = btn.dataset.tool;
document.querySelectorAll('.tool-btn').forEach(b => {
b.classList.remove('bg-[#38bdf8]/20', 'border-[#38bdf8]');
b.classList.add('border-white/20');
});
btn.classList.remove('border-white/20');
btn.classList.add('bg-[#38bdf8]/20', 'border-[#38bdf8]');
};
});

document.getElementById('clear-canvas').onclick = () => {
const cvs = document.getElementById('drawing-canvas');
ctx.clearRect(0, 0, cvs.width, cvs.height);
};

document.getElementById('post-drawing-btn').onclick = () => {
if(confirm("Post your art to the public gallery?")) {
const cvs = document.getElementById('drawing-canvas');
const dataUrl = cvs.toDataURL('image/png');
allGallery.unshift({ user: currentUser, data: dataUrl, time: Date.now() });
saveData('relax_gallery', allGallery);
renderGallery();
alert("Posted!");
}
};

// --- MINI GAME: BLOCK BLAST (Simplified) ---
function initBlockBlast() {
const grid = document.getElementById('bb-grid');
grid.innerHTML = '';
// 8x8 Grid
for(let i=0; i<64; i++) {
const cell = document.createElement('div');
cell.className = "bb-cell w-full h-full bg-white/10 rounded-sm";
cell.dataset.idx = i;
cell.onclick = () => placeBlock(i);
grid.appendChild(cell);
}

// Spawn shapes (Buttons for simplicity)
const shapesDiv = document.getElementById('bb-shapes');
shapesDiv.innerHTML = '';
['‚ñ†', '‚ñ¨', 'L'].forEach(s => {
const btn = document.createElement('button');
btn.className = "bb-shape-btn w-10 h-10 bg-white/10 rounded flex items-center justify-center font-bold text-lg hover:bg-white/20";
btn.textContent = s;
btn.onclick = () => selectShape(s, btn);
shapesDiv.appendChild(btn);
});
}

let selectedShape = null;
let bbScore = 0;

function selectShape(shape, btn) {
selectedShape = shape;
document.querySelectorAll('.bb-shape-btn').forEach(b => b.classList.remove('selected'));
btn.classList.add('selected');
}

function placeBlock(idx) {
if(!selectedShape) return;
const cells = document.querySelectorAll('.bb-cell');

// Simple logic: just color the clicked cell + neighbors based on shape
let indices = [idx];
if(selectedShape === '‚ñ¨') {
if((idx+1)%8 !== 0) indices.push(idx+1); // Right
} else if (selectedShape === 'L') {
if(idx+8 < 64) indices.push(idx+8); // Down
if((idx+1)%8 !== 0) indices.push(idx+1); // Right
} else {
// Square (2x2)
if((idx+1)%8 !== 0) indices.push(idx+1);
if(idx+8 < 64) indices.push(idx+8);
if(idx+9 < 64 && (idx+1)%8 !== 0) indices.push(idx+9);
}

// Check bounds and empty
const valid = indices.every(i => i < 64 && !cells[i].classList.contains('bg-[#38bdf8]'));

if(valid) {
indices.forEach(i => {
cells[i].classList.remove('bg-white/10');
cells[i].classList.add('bg-[#38bdf8]');
});
bbScore += indices.length * 10;
document.getElementById('bb-score').textContent = bbScore;
// Check lines (Simplified: clear random lines for effect)
checkLines();
}
}

function checkLines() {
// Just a dummy visual clear for satisfaction
const cells = document.querySelectorAll('.bb-cell');
// If row full (logic omitted for brevity, just random clear chance)
if(Math.random() > 0.8) {
cells.forEach(c => {
if(Math.random() > 0.5 && c.classList.contains('bg-[#38bdf8]')) {
c.classList.remove('bg-[#38bdf8]');
c.classList.add('bg-white/10');
bbScore += 50;
}
});
document.getElementById('bb-score').textContent = bbScore;
}
}

document.getElementById('bb-reset').onclick = () => {
bbScore = 0;
document.getElementById('bb-score').textContent = '0';
initBlockBlast();
};

// --- MINI GAME: POPCORN (Canvas Physics) ---
let popCvs, popCtx, kernels = [], popAnim;

function initPopcorn() {
popCvs = document.getElementById('popcorn-canvas');
popCtx = popCvs.getContext('2d');
kernels = [];
cancelAnimationFrame(popAnim);
document.getElementById('popcorn-score').textContent = "0";
}

document.getElementById('popcorn-reset').onclick = () => {
if(document.getElementById('popcorn-reset').textContent === "Start") {
document.getElementById('popcorn-reset').textContent = "Stop";
spawnKernel();
popLoop();
} else {
document.getElementById('popcorn-reset').textContent = "Start";
cancelAnimationFrame(popAnim);
}
};

function spawnKernel() {
if(document.getElementById('popcorn-reset').textContent !== "Stop") return;
kernels.push({
x: Math.random() * popCvs.width,
y: popCvs.height - 10,
vx: (Math.random() - 0.5) * 10,
vy: -(Math.random() * 10 + 10),
popped: false,
color: '#eab308'
});
setTimeout(spawnKernel, 500);
}

function popLoop() {
popCtx.clearRect(0,0,popCvs.width, popCvs.height);

kernels.forEach((k, i) => {
k.x += k.vx;
k.y += k.vy;
k.vy += 0.5; // Gravity

// Bounce
if(k.y > popCvs.height - 5) {
k.y = popCvs.height - 5;
k.vy *= -0.7;
}
if(k.x < 0 || k.x > popCvs.width) k.vx *= -1;

// Pop logic
if(!k.popped && k.vy > 0 && Math.random() > 0.95) {
k.popped = true;
k.color = '#ffffff';
k.vx = (Math.random() - 0.5) * 2;
k.vy = -5;
let s = parseInt(document.getElementById('popcorn-score').textContent);
document.getElementById('popcorn-score').textContent = s + 1;
}

popCtx.fillStyle = k.color;
popCtx.beginPath();
popCtx.arc(k.x, k.y, k.popped ? 8 : 4, 0, Math.PI*2);
popCtx.fill();
});

popAnim = requestAnimationFrame(popLoop);
}

// --- MINI GAME: SNAKE BATTLE ---
const snakeMenu = document.getElementById('snake-menu');
const snakeServers = document.getElementById('snake-servers');
const snakeLobby = document.getElementById('snake-lobby');
const snakePlay = document.getElementById('snake-play-area');

// Snake Nav
document.getElementById('snake-single-btn').onclick = () => {
snakeMenu.classList.add('hidden');
snakePlay.classList.remove('hidden');
snakePlay.classList.add('flex');
startSnakeGame();
};

document.getElementById('snake-online-btn').onclick = () => {
snakeMenu.classList.add('hidden');
snakeServers.classList.remove('hidden');
snakeServers.classList.add('flex');
};

document.querySelectorAll('.server-item').forEach(btn => {
btn.onclick = () => {
const serverName = btn.dataset.server;
snakeServers.classList.add('hidden');
snakeLobby.classList.remove('hidden');
snakeLobby.classList.add('flex');
document.getElementById('lobby-server-name').textContent = serverName;

// Simulating lobby join
const lobbyList = document.getElementById('lobby-list');
lobbyList.innerHTML = `<div class="text-xs p-2 bg-white/5 mb-1 rounded flex justify-between"><span>${currentUser} (You)</span> <span class="text-yellow-400">Ready</span></div>`;

// Add fake players
setTimeout(() => {
lobbyList.innerHTML += `<div class="text-xs p-2 bg-white/5 mb-1 rounded flex justify-between"><span>Guest_99</span> <span class="text-green-400">Ready</span></div>`;
}, 1000);

setTimeout(() => {
const startBtn = document.getElementById('lobby-start-btn');
startBtn.textContent = "Starting Game...";
startBtn.classList.remove('opacity-50', 'cursor-not-allowed');
startBtn.onclick = () => {
snakeLobby.classList.add('hidden');
snakePlay.classList.remove('hidden');
snakePlay.classList.add('flex');
startSnakeGame();
};
}, 2000);
};
});

document.getElementById('back-to-menu').onclick = () => {
snakeServers.classList.add('hidden');
snakeMenu.classList.remove('hidden');
};

document.getElementById('snake-quit').onclick = () => {
clearInterval(snakeInterval);
snakePlay.classList.add('hidden');
snakeMenu.classList.remove('hidden');
};

// Snake Game Logic
let snakeInterval;
function startSnakeGame() {
const cvs = document.getElementById('snake-canvas');
const ctx = cvs.getContext('2d');
const tile = 20;
let snake = [{x: 10*tile, y: 10*tile}];
let food = {x: 15*tile, y: 15*tile};
let dx = tile;
let dy = 0;
let score = 0;

document.getElementById('snake-status-text').textContent = "Playing...";

// Controls
document.addEventListener('keydown', changeDir);
function changeDir(e) {
const LEFT = 37, RIGHT = 39, UP = 38, DOWN = 40;
if(e.keyCode === LEFT && dx === 0) { dx = -tile; dy = 0; }
if(e.keyCode === UP && dy === 0) { dx = 0; dy = -tile; }
if(e.keyCode === RIGHT && dx === 0) { dx = tile; dy = 0; }
if(e.keyCode === DOWN && dy === 0) { dx = 0; dy = tile; }
}

// Game Loop
clearInterval(snakeInterval);
snakeInterval = setInterval(() => {
// Move
const head = {x: snake[0].x + dx, y: snake[0].y + dy};

// Check Collision
if(head.x < 0 || head.x >= cvs.width || head.y < 0 || head.y >= cvs.height || collision(head, snake)) {
clearInterval(snakeInterval);
document.getElementById('snake-status-text').textContent = "Game Over! Score: " + score;
return;
}

snake.unshift(head);

// Eat Food
if(head.x === food.x && head.y === food.y) {
score++;
food = {
x: Math.floor(Math.random() * (cvs.width/tile)) * tile,
y: Math.floor(Math.random() * (cvs.height/tile)) * tile
};
} else {
snake.pop();
}

// Draw
ctx.fillStyle = '#2a2a2a';
ctx.fillRect(0,0,cvs.width, cvs.height);

ctx.fillStyle = '#ef4444'; // Food
ctx.fillRect(food.x, food.y, tile-2, tile-2);

ctx.fillStyle = '#38bdf8'; // Snake
snake.forEach(s => ctx.fillRect(s.x, s.y, tile-2, tile-2));

}, 100);

function collision(head, array) {
for(let i=0; i<array.length; i++) {
if(head.x === array[i].x && head.y === array[i].y) return true;
}
return false;
}
}

// --- EXTERNAL LINK PLACEHOLDER ---
// Example: Adding a footer link container
const appWrapper = document.getElementById('relax-app');
const footerLinkDiv = document.createElement('div');
footerLinkDiv.className = "fixed bottom-1 right-1 opacity-30 hover:opacity-100 text-[10px]";

// // Uncomment the line below and replace # with your URL
// footerLinkDiv.innerHTML = '<a href="#" target="_blank" class="text-white underline">External Link</a>';

appWrapper.appendChild(footerLinkDiv);

</script>
</body>
</html>


